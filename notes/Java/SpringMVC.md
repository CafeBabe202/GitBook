#  SpringMVC

其实本来并不像写SpringMVC的教程，因为刚开始感觉并没有太多的改的东西，所以并没有写教程，但是今天手动搭建一个SSM的环境，而没有使用SpringBoot，感觉还是有必要写一写博客笔记的。

没有手动搭建过SSM的人永远也不知道SpringBoot到底有多方便。

## 原生JavaWeb

首先然我们来回想下原生的javaWeb的一些基础的相关功能。

### jsp

jsp（JavaServerPage）是javaWeb的页面格式，在其中你可以写html代码，并插入少量的java代码来让你的页面实现动态的效果（并不是会动的GIF，而是动态页面）。在你的项目启动的时候，jsp文件并不会加载，只有当一个页面第一次被请求的时候，tomcat会将你的jsp页面生成servlet类的字节码文件（tomcat会监控的文件变动，只要你改过，然后再次进行请求的时候就要进行编译），并生成一个实例对象，然后将执行的结果返回给你。

当用户请求一个jsp页面时，tomcat服务器会跟会你请求的路径来执行对应的servlet方法，然后将结果返回给用户。

### setvlet

在tomcat中，除了有jsp页面生成setvlet之外，还能通过集成servlet类来实现你自己的servlet。你的大部分java代码是应该放在stelvet中的。

想要一个serlvet能够被成的访问，除了正确的编写你的代码之外，还要告诉tomcat服务器用户请求那个地址时执行这个serlvet。你首先需要在web.xml文件中声明一个servlet，然后配置他的映射路径。

### 请求和响应

我想你肯定知道请求的方式是分为两种的，post和get，对，处理着这两种请求你需要重写setvlet中对应的来不同的方法，这似乎方便，但是也并不怎么方便。

用相应的方式来形容似乎有点不太恰当，但是我也想不到其他的方式来形容这个了。响应的话分为转发和重定向两种，我想你应该知道都是什么东西。你可以通过**request.getRequestDispatcher("hello.jsp").forward(request, response)**来进行转发，转发是由服务器内部进行完成的，用户不知情，浏览器的地址栏同样不会因此而改变；同样的你可以通过**response.sendRedirect("url")**来进行重定向，重定向是要服务器相应一个302来通知浏览器重定向到新的地址完成的，因此，浏览器的地址栏的内容会因此而改变。

## 尝试

我想在学习springMVC之前，你肯定是写过一些原生的javaWeb项目，如果你没有写过，那就现在去实现一个自己的web项目，不同过于复杂，只需要进行一些简单的CURD操作就好，我想你会觉得遇到很多坑，自己从坑里爬出来，然后掉进下一个坑。成长就是这样的。

好了，现在假设你写过至少一个javaweb项目，那就来简单的聊聊的那烦人的原生javaweb。

### servlet

在原生的javaWeb中，每一个servlet都继承servlet的抽象类，有的功能很简单，可能只是从你的数据中查询一个数据，然后将它返回给前端的服务器，但是你必须要创建类，集成servlet，然后配置web.xml。一两个还好，但是如果你有几十个甚至几百个这样的模块你会抓狂的。

聪明的人肯能会想一些办法来减少他的工作量，一个很有效的办法就是如果所有的请求都被通过一servlet来拦截，然后通过一些简单的规则来执行那些简单的模块就会方便很多，你还可以通过更好的方式来管理你的地址映射，因为所有的请求都被拦截到了，你可以根据请求的地址通过反射来执行代码，这似乎很明智，你可以去试一试。

### jsp

之所以使用jsp就是因为它可以嵌入java代码，让那后动态的来显示内容，而不是像html那样傻乎乎的只能显示静态的东西。但是这样你会发现在jsp中写java代码似乎是一件很不友好的工作。那奇奇怪怪的标签，零零散散的代码段，真的是令人头大。

这个问题似乎并不能解决，它好象是由jsp的语法决定的。是的，我觉得也是，但是你可以通过一些方法来缓解这个问题，比如说你可以通过一个其他部分的代码来实现大部分的逻辑，然后通过简单json结果赋值给html中的javascript变量，然后**让javascript来帮你**解析数据到html中，这应该会减少很多那中带有混合代码的循环（想想那零零散散混合代码的循环体就头大）。如果你很有实例，可以自己写一些工具类，来帮助你生成那种很有规律，但是又让人头大的代码。

### 获取数据

获取数据看似很简单，**request.getParameter()**，这看起来很容易，但是由前端传过来的参数奇形怪状，你需要处理各种异常，并且你有很多多参数，不同太多，十来个就已经让人绝望了。

没有什么问题是使用工具类解决不了的，你同样可以通过通过编写utils类来帮助你完成这项工作，因为你会发现处理每一个参数的代码都是类似的，所以你可以通过一个很简单的utils来实现参数转化的这项功能。

### 总结

现在来让我们想想刚刚发生了什么？我们通过实践来发现了几个让人头疼的问题，然后通过自己的才智不同程度的解决了一些问题，如果你的工具写的比较完美，你的工作将更加轻松，甚至是减轻了一半的工作量。然我们来总结一下这些问题。

1. 管理那烦人的地址映射：

   通过一个servlet来拦截所有的请求，然后通过一种自定义的，更简单的方式来管理你的地址与java类或者方法的关系，通过反射来调用功能。

2. 每个servlet都要实现抽象类

   这很烦，但是我同样是使用上边的方法来解决了问题，我们太通过反射来执行方法，这就很轻松，毕竟现在你只有一个servlet，只需要在知道该执行那个方法之后去通过反射执行它，然后将结果返回就行了。

3. 烦人的jsp标签

   jsp的变迁很烦人，我们这次没有使用java来解决问题，而是通过javascript来帮助我们来解析数据到html中。

4. 获取数据

   我感觉这是最好解决的一个问题了，通过一个utils类帮助你解析从前台传输过来的数据，然后以一种标准的形式来返回数据。

现在，来让我们给你的工具起一个高大上的名字。

你的唯一的一个servlet：DispatcherServlet

用来映射你的地址与指定的类的方法进行映射的工具：HandlerMapping

同来通过反射执行你的类并返回结果的工具：HandlerAdapter

你的用来解析数据到html的javascript代码：ViewResoler

这些名是不是看起来很洋气。现在你捋一捋他们的执行顺序，你就会得到下边的这张图：（来源于网络）

![SpringMVC执行流程](SpringMVC.assets/SpringMVC%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B.png)
